(this.webpackJsonpexpenses=this.webpackJsonpexpenses||[]).push([[0],{41:function(e,t,n){},46:function(e,t,n){},70:function(e,t,n){},72:function(e,t,n){},73:function(e,t,n){"use strict";n.r(t);var s=n(0),a=n(1),i=n(18),c=n.n(i),o=n(22),r=n(7),l=n(8),d=n(23),p=n(10),u=n(9),h=function(e){Object(p.a)(n,e);var t=Object(u.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(s.jsx)("span",{className:"mdc-list-item__start-detail ".concat(this.props.icon),role:"presentation",children:Object(s.jsx)("i",{className:"material-icons","aria-hidden":"true",children:this.props.icon||"attach_money"})})}}]),n}(a.Component),m=function(e){Object(p.a)(n,e);var t=Object(u.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(s.jsxs)("li",{className:"mdc-list-item",onClick:function(){return e.props.onSelect(e.props.expense)},children:[Object(s.jsx)(h,{icon:this.props.expense.icon}),Object(s.jsxs)("span",{className:"mdc-list-item__text",children:[this.props.expense.category," (",this.props.expense.topic,")",Object(s.jsxs)("span",{className:"mdc-list-item__text__secondary",children:[this.props.expense.date,this.props.expense.description?" ".concat(this.props.expense.description.replace(/^(.{14}).+/,"$1\u2026")):""]})]}),Object(s.jsxs)("span",{className:"mdc-list-item__end-detail",children:["$",this.props.expense.amount]})]})}}]),n}(a.Component),b=(n(40),n(41),function(e){Object(p.a)(n,e);var t=Object(u.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){var e=this;return Object(s.jsx)("ul",{className:"mdc-list mdc-list--two-line mdc-list--avatar-list",children:this.props.expenses.map((function(t){return Object(s.jsx)(m,{expense:t,onSelect:e.props.onSelect},t.id)}))})}}]),n}(a.Component)),j=n(31),x=n(32),f=(n(42),n(43),n(44),n(28),n(45),n(46),n(27)),g=n(4),v=n(34),O=function(e){Object(p.a)(n,e);var t=Object(u.a)(n);function n(e){var a;Object(r.a)(this,n),a=t.call(this,e);var i=g.f.Option;return a.customSelectOption=function(e){return Object(s.jsxs)(i,Object(f.a)(Object(f.a)({},e),{},{children:[Object(s.jsx)("i",{className:"material-icons","aria-hidden":"true",children:e.data.icon||"attach_money"}),e.data.label]}))},a.customSelectValue=function(e){return Object(s.jsxs)("div",{children:[Object(s.jsx)("i",{className:"material-icons","aria-hidden":"true",children:e.data.icon||"attach_money"}),e.data.label]})},a}return Object(l.a)(n,[{key:"render",value:function(){return Object(s.jsx)(v.a,{value:this.props.value,onChange:this.props.onChange,options:this.props.options,components:{Option:this.customSelectOption,SingleValue:this.customSelectValue}})}}]),n}(a.Component),y=function(e){Object(p.a)(n,e);var t=Object(u.a)(n);function n(e){var s;return Object(r.a)(this,n),(s=t.call(this,e)).handleInputChange=function(e){var t=e.target;t.reportValidity(),s.setState({isValid:s.form.checkValidity()}),s.props.onChange(t.name,t.value)},s.handleCategoryChange=function(e){var t=e.value;if(!t)throw"Category cannot be empty";s.setState({isValid:s.form.checkValidity()}),s.props.expense.category=t,s.props.expense.topic="topic-mock",s.props.expense.icon="face"},s.handleSubmit=function(e){e.preventDefault(),s.props.expense.date=s.parseDate(s.props.expense.date),s.props.onSubmit()},s.initializeDeleteModal=function(e){e&&(s.dialog=new x.MDCDialog(e),s.dialog.listen("MDCDialog:accept",(function(){document.body.className=document.body.className.replace("mdc-dialog-scroll-lock",""),s.props.onDelete(s.props.expense)})))},s.state={isValid:!1},s}return Object(l.a)(n,[{key:"componentDidMount",value:function(){document.querySelectorAll(".mdc-textfield").forEach((function(e){new j.MDCTextfield(e)})),void 0===this.props.expense.id&&this.amountInput.focus()}},{key:"parseDate",value:function(e){if(!e||-1!==e.indexOf("-"))return e;var t=e.split("/"),n=+t[2]+2e3,s=t[1].length<2?"0".concat(t[1]):t[1],a=t[0].length<2?"0".concat(t[0]):t[0];return"".concat(n,"-").concat(s,"-").concat(a)}},{key:"render",value:function(){var e=this;return Object(s.jsxs)("form",{onSubmit:this.handleSubmit,ref:function(t){e.form=t},noValidate:!0,children:[Object(s.jsx)("aside",{className:"mdc-dialog",ref:this.initializeDeleteModal,children:Object(s.jsxs)("div",{className:"mdc-dialog__surface",children:[Object(s.jsx)("header",{className:"mdc-dialog__header",children:Object(s.jsx)("h2",{className:"mdc-dialog__header__title",children:"Are you sure?"})}),Object(s.jsx)("section",{className:"mdc-dialog__body",children:"Do you really want to delete the expense?"}),Object(s.jsxs)("footer",{className:"mdc-dialog__footer",children:[Object(s.jsx)("button",{type:"button",className:"mdc-button mdc-dialog__footer__button mdc-dialog__footer__button--cancel",children:"Cancel"}),Object(s.jsx)("button",{type:"button",className:"mdc-button mdc-dialog__footer__button mdc-dialog__footer__button--accept",children:"Delete"})]})]})}),Object(s.jsx)("div",{className:"mdc-form-field",children:Object(s.jsxs)("div",{className:"mdc-textfield",children:[Object(s.jsx)("input",{name:"amount",className:"mdc-textfield__input",ref:function(t){e.amountInput=t},value:this.props.expense.amount,onChange:this.handleInputChange,type:"number",step:"0.01",min:"0",required:!0}),Object(s.jsx)("label",{className:"mdc-textfield__label",children:"Amount"})]})}),Object(s.jsx)("div",{className:"mdc-form-field",children:Object(s.jsx)(O,{name:"category",value:{value:this.props.expense.category,label:this.props.expense.category,icon:this.props.icons[this.props.expense.category],topic:this.props.topics[this.props.expense.category]},onChange:this.handleCategoryChange,options:this.props.categories.map((function(t){return{value:t,label:t,icon:e.props.icons[t],topic:e.props.topics[t]}}))})}),Object(s.jsx)("div",{className:"mdc-form-field",children:Object(s.jsxs)("div",{className:"mdc-textfield",children:[Object(s.jsx)("input",{name:"description",className:"mdc-textfield__input",value:this.props.expense.description,onChange:this.handleInputChange,type:"text"}),Object(s.jsx)("label",{className:"mdc-textfield__label",children:"Description"})]})}),Object(s.jsx)("div",{className:"mdc-form-field",children:Object(s.jsxs)("div",{className:"mdc-textfield",children:[Object(s.jsx)("input",{name:"date",className:"mdc-textfield__input",value:this.parseDate(this.props.expense.date),onChange:this.handleInputChange,type:"date",required:!0}),Object(s.jsx)("label",{className:"mdc-textfield__label",children:"Date"})]})}),Object(s.jsx)("div",{className:"mdc-form-field",children:Object(s.jsx)("select",{name:"account",className:"mdc-select",value:this.props.expense.account,onChange:this.handleInputChange,required:!0,children:this.props.accounts.map((function(e){return Object(s.jsx)("option",{value:e,children:e},e)}))})}),Object(s.jsxs)("div",{className:"mdc-form-field mdc-form-submit",children:[Object(s.jsx)("input",{type:"submit",className:"mdc-button",value:this.props.expense.id?"Update":"Add",disabled:!this.state.isValid}),this.props.expense.id&&Object(s.jsx)("input",{type:"button",className:"mdc-button",onClick:function(){return e.dialog.show()},value:"Delete"}),Object(s.jsx)("input",{type:"button",className:"mdc-button",onClick:function(){return e.props.onCancel()},value:"Close"})]})]})}}]),n}(a.Component),_=function(e){Object(p.a)(n,e);var t=Object(u.a)(n);function n(){return Object(r.a)(this,n),t.apply(this,arguments)}return Object(l.a)(n,[{key:"render",value:function(){return Object(s.jsx)("div",{className:"center",children:Object(s.jsxs)("svg",{width:"80px",height:"80px",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 100 100",preserveAspectRatio:"xMidYMid",children:[Object(s.jsxs)("circle",{cx:"84",cy:"50",r:"0",fill:"#c0f6d2",children:[Object(s.jsx)("animate",{attributeName:"r",values:"11;0;0;0;0",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"1s",repeatCount:"indefinite",begin:"0s"}),Object(s.jsx)("animate",{attributeName:"cx",values:"84;84;84;84;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"1s",repeatCount:"indefinite",begin:"0s"})]}),Object(s.jsxs)("circle",{cx:"40.0957",cy:"50",r:"11",fill:"#ff7c81",children:[Object(s.jsx)("animate",{attributeName:"r",values:"0;11;11;11;0",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"1s",repeatCount:"indefinite",begin:"-0.5s"}),Object(s.jsx)("animate",{attributeName:"cx",values:"16;16;50;84;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"1s",repeatCount:"indefinite",begin:"-0.5s"})]}),Object(s.jsxs)("circle",{cx:"16",cy:"50",r:"7.79567",fill:"#fac090",children:[Object(s.jsx)("animate",{attributeName:"r",values:"0;11;11;11;0",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"1s",repeatCount:"indefinite",begin:"-0.25s"}),Object(s.jsx)("animate",{attributeName:"cx",values:"16;16;50;84;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"1s",repeatCount:"indefinite",begin:"-0.25s"})]}),Object(s.jsxs)("circle",{cx:"84",cy:"50",r:"3.20433",fill:"#ffffcb",children:[Object(s.jsx)("animate",{attributeName:"r",values:"0;11;11;11;0",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"1s",repeatCount:"indefinite",begin:"0s"}),Object(s.jsx)("animate",{attributeName:"cx",values:"16;16;50;84;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"1s",repeatCount:"indefinite",begin:"0s"})]}),Object(s.jsxs)("circle",{cx:"74.0957",cy:"50",r:"11",fill:"#c0f6d2",children:[Object(s.jsx)("animate",{attributeName:"r",values:"0;0;11;11;11",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"1s",repeatCount:"indefinite",begin:"0s"}),Object(s.jsx)("animate",{attributeName:"cx",values:"16;16;16;50;84",keyTimes:"0;0.25;0.5;0.75;1",keySplines:"0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1;0 0.5 0.5 1",calcMode:"spline",dur:"1s",repeatCount:"indefinite",begin:"0s"})]})]})})}}]),n}(a.Component),N=n(33),k=function(){function e(t,n){Object(r.a)(this,e),this.clientId=t,this.spreadsheetId=n}return Object(l.a)(e,[{key:"login",value:function(e){var t=this;window.gapi.load("client:auth2",(function(){window.gapi.client.init({discoveryDocs:["https://sheets.googleapis.com/$discovery/rest?version=v4"],clientId:t.clientId,scope:"https://www.googleapis.com/auth/spreadsheets https://www.googleapis.com/auth/drive.metadata.readonly"}).then((function(){t.getAuthInstance().isSignedIn.listen(e),e(t.getAuthInstance().isSignedIn.get())}))}))}},{key:"getAuthInstance",value:function(){return window.gapi.auth2.getAuthInstance()}},{key:"append",value:function(e){return window.gapi.client.sheets.spreadsheets.values.append({spreadsheetId:this.spreadsheetId,range:"Expenses!A1",valueInputOption:"USER_ENTERED",insertDataOption:"INSERT_ROWS",values:[e]})}},{key:"update",value:function(e,t){return window.gapi.client.sheets.spreadsheets.values.update({spreadsheetId:this.spreadsheetId,range:e,valueInputOption:"USER_ENTERED",values:[t]})}},{key:"delete",value:function(e){return window.gapi.client.sheets.spreadsheets.batchUpdate({spreadsheetId:this.spreadsheetId,resource:{requests:[{deleteDimension:{range:{sheetId:0,dimension:"ROWS",startIndex:e-1,endIndex:e}}}]}})}},{key:"load",value:function(){return window.gapi.client.sheets.spreadsheets.values.batchGet({spreadsheetId:this.spreadsheetId,ranges:["Data!A2:A200","Data!E2:E200","Data!F2:F200","Data!G2:G200","Expenses!A2:F","Current!H1","Previous!H1"]})}}]),e}(),S=(n(66),n(67),n(68),n(69),n(70),function(e){Object(p.a)(n,e);var t=Object(u.a)(n);function n(){var e;return Object(r.a)(this,n),(e=t.call(this)).onKeyPressed=function(t){!0===e.state.signedIn&&(!1===e.state.showExpenseForm?65===t.keyCode&&e.onExpenseNew():27===t.keyCode&&e.handleExpenseCancel())},e.signedInChanged=function(t){e.setState({signedIn:t}),e.state.signedIn&&e.load()},e.handleExpenseSubmit=function(){e.setState({processing:!0,showExpenseForm:!1}),(e.state.expense.id?e.update:e.append).bind(Object(d.a)(e))(e.state.expense).then((function(){e.snackbar.show({message:"Expense ".concat(e.state.expense.id?"updated":"added","!")}),e.load()}),(function(t){console.error("Something went wrong"),console.error(t),e.setState({loading:!1})}))},e.handleExpenseChange=function(t,n){e.setState({expense:Object.assign({},e.state.expense,Object(o.a)({},t,n))})},e.handleExpenseDelete=function(t){e.setState({processing:!0,showExpenseForm:!1});var n=t.id.substring(10);e.sheetService.delete(n).then((function(){e.snackbar.show({message:"Expense deleted!"}),e.load()}),(function(t){console.error("Something went wrong"),console.error(t),e.setState({loading:!1})}))},e.handleExpenseSelect=function(t){e.setState({expense:t,showExpenseForm:!0})},e.handleExpenseCancel=function(){e.setState({showExpenseForm:!1})},e.clientId="758679234250-t9fh8t8ph9pssqb5kekseinfgout8f9i.apps.googleusercontent.com",e.spreadsheetId="1Z-1RXh51c74cw4KMzuSfZ_8NZ34qbNz0McOZMLOyOrY",e.state={signedIn:void 0,accounts:[],categories:[],expenses:[],processing:!0,expense:{},currentMonth:void 0,previousMonth:void 0,showExpenseForm:!1},e.sheetService=new k(e.clientId,e.spreadsheetId),e}return Object(l.a)(n,[{key:"componentDidMount",value:function(){this.sheetService.login(this.signedInChanged),document.addEventListener("keyup",this.onKeyPressed.bind(this))}},{key:"onExpenseNew",value:function(){var e=new Date;this.setState({showExpenseForm:!0,expense:{amount:"",description:"",date:"".concat(e.getFullYear(),"-").concat(e.getMonth()<9?"0"+(e.getMonth()+1):e.getMonth()+1,"-").concat(e.getDate()<10?"0"+e.getDate():e.getDate()),category:this.state.categories[0],account:this.state.accounts[0]}})}},{key:"parseExpense",value:function(e,t,n,s){var a=e[3];return{id:"Expenses!A".concat(t+2),date:e[0],description:e[1],category:a,topic:n[a],icon:s[a],amount:e[4].replace(",",""),account:e[2]}}},{key:"formatExpense",value:function(e){return["=DATE(".concat(e.date.substr(0,4),", ").concat(e.date.substr(5,2),", ").concat(e.date.substr(-2),")"),e.description,e.account,e.category,e.amount]}},{key:"append",value:function(e){return this.sheetService.append(this.formatExpense(e))}},{key:"update",value:function(e){return this.sheetService.update(e.id,this.formatExpense(e))}},{key:"load",value:function(){var e=this;this.sheetService.load().then((function(t){for(var n=t.result.valueRanges,s=n[0].values.map((function(e){return e[0]})),a=n[1].values.map((function(e){return e[0]})),i={},c={},o=0;o<Math.min(a.length,n[2].values.length,n[3].values.length);o++)i[a[o]]=n[2].values[o][0],c[a[o]]=n[3].values[o][0];e.setState({accounts:s,categories:a,topics:i,icons:c,expenses:(n[4].values||[]).map((function(t,n){return e.parseExpense(t,n,i,c)})).reverse().slice(0,30),processing:!1,currentMonth:n[5].values[0][0],previousMonth:n[6].values[0][0]})}))}},{key:"render",value:function(){var e=this;return Object(s.jsxs)("div",{children:[Object(s.jsx)("header",{className:"mdc-toolbar mdc-toolbar--fixed",children:Object(s.jsxs)("div",{className:"mdc-toolbar__row",children:[Object(s.jsx)("section",{className:"mdc-toolbar__section mdc-toolbar__section--align-start",children:Object(s.jsx)("span",{className:"mdc-toolbar__title",children:"Expenses"})}),Object(s.jsxs)("section",{className:"mdc-toolbar__section mdc-toolbar__section--align-end",role:"toolbar",children:[!1===this.state.signedIn&&Object(s.jsx)("a",{className:"material-icons mdc-toolbar__icon","aria-label":"Sign in",alt:"Sign in",onClick:function(t){t.preventDefault(),e.sheetService.getAuthInstance().signIn()},children:"perm_identity"}),this.state.signedIn&&Object(s.jsx)("a",{className:"material-icons mdc-toolbar__icon","aria-label":"Sign out",alt:"Sign out",onClick:function(t){t.preventDefault(),e.sheetService.getAuthInstance().signOut()},children:"exit_to_app"})]})]})}),Object(s.jsxs)("div",{className:"toolbar-adjusted-content",children:[void 0===this.state.signedIn&&Object(s.jsx)(_,{}),!1===this.state.signedIn&&Object(s.jsx)("div",{className:"center",children:Object(s.jsx)("button",{className:"mdc-button sign-in","aria-label":"Sign in",onClick:function(){e.sheetService.getAuthInstance().signIn()},children:"Sign In"})}),this.state.signedIn&&this.renderBody()]}),Object(s.jsxs)("div",{ref:function(t){t&&(e.snackbar=new N.MDCSnackbar(t))},className:"mdc-snackbar","aria-live":"assertive","aria-atomic":"true","aria-hidden":"true",children:[Object(s.jsx)("div",{className:"mdc-snackbar__text"}),Object(s.jsx)("div",{className:"mdc-snackbar__action-wrapper",children:Object(s.jsx)("button",{type:"button",className:"mdc-button mdc-snackbar__action-button","aria-hidden":"true"})})]})]})}},{key:"renderBody",value:function(){return this.state.processing?Object(s.jsx)(_,{}):Object(s.jsx)("div",{className:"content",children:this.renderExpenses()})}},{key:"renderExpenses",value:function(){var e=this;return this.state.showExpenseForm?Object(s.jsx)(y,{categories:this.state.categories,icons:this.state.icons,topics:this.state.topics,accounts:this.state.accounts,expense:this.state.expense,onSubmit:this.handleExpenseSubmit,onCancel:this.handleExpenseCancel,onDelete:this.handleExpenseDelete,onChange:this.handleExpenseChange}):Object(s.jsxs)("div",{children:[Object(s.jsxs)("div",{className:"mdc-card",children:[Object(s.jsxs)("section",{className:"mdc-card__primary",children:[Object(s.jsx)("h2",{className:"mdc-card__subtitle",children:"This month you've spent:"}),Object(s.jsx)("h1",{className:"mdc-card__title mdc-card__title--large center",children:this.state.currentMonth})]}),Object(s.jsxs)("section",{className:"mdc-card__supporting-text",children:["Previous month: ",this.state.previousMonth]})]}),Object(s.jsx)(b,{expenses:this.state.expenses,onSelect:this.handleExpenseSelect}),Object(s.jsx)("button",{onClick:function(){return e.onExpenseNew()},className:"mdc-fab app-fab--absolute material-icons","aria-label":"Add expense",children:Object(s.jsx)("span",{className:"mdc-fab__icon",children:"add"})})]})}}]),n}(a.Component));n(71),n(72);c.a.render(Object(s.jsx)(S,{}),document.getElementById("root")),"serviceWorker"in navigator&&window.addEventListener("load",(function(){var e="".concat("https://brommz.github.io/expenses","/service-worker.js");navigator.serviceWorker.register(e).then((function(e){e.onupdatefound=function(){var t=e.installing;t.onstatechange=function(){"installed"===t.state&&(navigator.serviceWorker.controller?console.log("New content is available; please refresh."):console.log("Content is cached for offline use."))}}})).catch((function(e){console.error("Error during service worker registration:",e)}))}))}},[[73,1,2]]]);
//# sourceMappingURL=main.52b95835.chunk.js.map